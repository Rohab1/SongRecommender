<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" type="text/css" href="Songrecommender.css">
  <title>Top 50 Songs</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>

    .dark-mode {
      background-color: #000000;
      color: #ffffff;
    }

  </style>
</head>

<body data-bs-spy="scroll" data-bs-target="#navbarNavDropdown" data-bs-offset="0" style="background-color: #000000">
  <div class="align-mid">
    <nav class="navbar navbar-expand-lg bg-dark bg-body-tertiary" data-bs-theme="dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="Formative Song Recommender.html">Home</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown"
          aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="chart.html">Top Songs Chart</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="scratch_2.html">Song By Genre</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="scratch_3.html">Song By Year</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#genreChartSection">Go to Genre Chart</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </div>
  <div class="container mt-5">
    <h2 style="color:#ffffff">Top 50 Songs</h2>
    <table class="table table-dark table-hover table-borderless">
      <thead>
        <tr class="table-dark">
          <th>#</th>
          <th>Track</th>
          <th>Artist</th>
          <th>Genre</th>
        </tr>
      </thead>
      <tbody id="table-body">
      </tbody>
    </table>

    <!-- Pie Chart -->
    <div id="genreChartSection" class="mt-5" >
      <h2 style="color:#ffffff" >Genre Distribution</h2>
      <canvas id="genreChart" ></canvas>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- To load CSV data -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      fetch('http://127.0.0.1:8080/Spotify-2000.csv') // Adjust the port if needed
        .then(response => response.text())
        .then(csvData => {
          const rows = csvData.split('\n').slice(1, 51); // Limit to the top 50 songs

          const tbody = document.getElementById('table-body');
          rows.forEach(row => {
            const columns = row.split(',');

            // Check if there are enough items in the columns array
            if (columns.length >= 4) {
              // Replace double quotes around each data item
              const sanitizedColumns = columns.map(item => item.replace(/"/g, ''));

              tbody.innerHTML += `
                <tr>
                  <td>${sanitizedColumns[0]}</td>
                  <td>${sanitizedColumns[1]}</td>
                  <td>${sanitizedColumns[2]}</td>
                  <td>${sanitizedColumns[3]}</td>
                </tr>
              `;
            }
          });

          // Create a pie chart
          const genres = rows.map(row => row.split(',')[3]?.trim()).filter(Boolean); // Extract genres
          const genresData = {};
          genres.forEach(genre => {
            genresData[genre] = (genresData[genre] || 0) + 1;
          });

          const ctx = document.getElementById('genreChart').getContext('2d');
          new Chart(ctx, {
            type: 'pie',
            data: {
              labels: Object.keys(genresData),
              datasets: [{
                data: Object.values(genresData),
              }],
            },
            options: {
              elements: {
                arc: {
                  borderWidth: 3.5,
                },
              },
              radius: '75%', // You can set it to a specific percentage or pixel value
            },
          });
        })
    });
  </script>

  <!-- Additional scripts for Bootstrap, jQuery, and Vanta.js -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="three.r134.min.js"></script>
  <script src="vanta.net.min.js"></script>

  <!-- Initialize Vanta.NET after the DOM has fully loaded -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Get the window dimensions
      var windowHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
      var windowWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;

      // Set the minimum height and width
      var minHeight = 700.00;
      var minWidth = 500.00;

      // Adjust minHeight and minWidth based on the device type
      if (windowWidth < minWidth) {
        minWidth = windowWidth;
      }
      if (windowHeight < minHeight) {
        minHeight = windowHeight;
      }

      VANTA.NET({
        el: "body",
        mouseControls: true,
        touchControls: true,
        gyroControls: false,
        minHeight: minHeight,
        minWidth: minWidth,
        scale: 1.00,
        scaleMobile: 1.00,
        color: 0x20b2aa,
        backgroundColor: 0x0,
        points: 20.00,
        maxDistance: 14.00,
        spacing: 10.00
      });
    });
  </script>
</body>

</html>
